{% extends "base.html" %}
{% block content %}
<h2>Members</h2>

{% for member in members %}
<section>
    <h3>{{ member.MemberName }} – {{ member.MainPosition }}</h3>
    <h4>Band</h4>
    <p><a href="{{ url_for('view_band', id=member.band.BandID) }}">{{ member.band.BandName }}</a> ({{ member.band.FormedYear }})</p>
    <p><strong>Home:</strong> {{ member.band.HomeLocation }}</p>
    
    <h4>Albums (with {{ member.band.BandName }})</h4>
    <ul>
    {% for album in member.band.albums %}
        <li>
            <a href="{{ url_for('view_album', id=album.AlbumID) }}">{{ album.AlbumTitle }}</a> ({{ album.ReleaseYear }})
            {% if album.bands|length > 1 %}
            <br><em>Collaboration with: 
            {% for collab_band in album.bands %}
            {% if collab_band.BandID != member.band.BandID %}
                <a href="{{ url_for('view_band', id=collab_band.BandID) }}">{{ collab_band.BandName }}</a>{% if not loop.last %}, {% endif %}
            {% endif %}
            {% endfor %}
            </em>
            {% endif %}
        </li>
    {% endfor %}
    </ul>
    
    <h4>Fellow Band Members</h4>
    <ul>
    {% for other_member in member.band.members %}
        {% if other_member.MemberID != member.MemberID %}
        <li><a href="{{ url_for('view_member', id=other_member.MemberID) }}">{{ other_member.MemberName }}</a> – {{ other_member.MainPosition }}</li>
        {% endif %}
    {% endfor %}
    </ul>
</section>
<hr>
{% endfor %}
{% endblock %}
